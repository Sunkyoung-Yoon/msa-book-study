# 2.1 스프링 클라우드란?

담당자: 박희선
</br>
</br>
</br>

시스템이 더 많이 분산될수록 실패할 곳은 더 많아진다 </br>
실패 지점을 회피하기 위해 스프링 클라우드 사용

> 스프링 클라우드는 최소한의 구성으로 마이크로서비스 아키텍처를 빠르게 구축할 수 있는 일련의 기능 제공

스프링 클라우드 </br>

- 스프링 팀이 시장에서 검증된 *수많은 오픈 소스 프로젝트를 모아* 통칭 스프링 클라우드라는 스프링의 하위 프로젝트
- 스프링 클라우드는 프로젝트 설정 및 구성을 단순화하고 가장 흔히 접할 수 있는 패턴의 해결안을 스프링 애플리케이션에 제공 </br> 👉 마이크로서비스 애플리케이션 만들고 배포하는 데 필요한 모든 인프라스트럭처 구성에 대한 세부 사항은 신경 쓰지 않은 채 코드 작성 가능

## 2.1.1 스프링 클라우드 컨피그

> 애플리케이션 구성 데이터 관리

- 애플리케이션 구성 데이터는 배포된 마이크로서비스에서 완전히 분리됨
- 따라서 아무리 많은 마이크로서비스 마이크로서비스 인스턴스를 실행하더라도 항상 동일한 구성 보장 가능
- 스프링 클라우드 컨피그는 자체 프로퍼티 관리 저장소가 있지만 오픈 소스 프로젝트와도 통합됨
  - 깃, 콘술, 유레카(넷플릭스 오픈 소스 프로젝트)

## 2.1.2 스프링 클라우드 서비스 디스커버리

> 서비스를 소비하는 클라이언트에서 서버가 배포된 물리적 위치 (IP 및 서버 이름) 추상화 가능

- 서비스 소비자는 물리적 위치가 아닌 논리적 이름 사용 -> 서버의 비즈니스 로직 호출
- 서비스 인스턴스가 시작되고 종료될 때 인스턴스 등록 및 등록 취소도 처리해줌
  - 콘술, 주키퍼, 유레카

## 2.1.3 스프링 클라우드 로드 밸런서와 Resilience4j

> 마이크로서비스 클라이언트 **_회복성 패턴_** 을 위해 스프링 클라우드는 Reilience4j 라이브러리와 스프링 클라우드 로드 밸런서 프로젝트를 포함

- Reilience4j 라이브러리 사용시 회로 차단기, 재시도, 벌크헤드 등 서비스 클라이언트 회복성 패턴을 빠르게 구현
- 스프링 클라우드 로드 밸런서 프로젝트는 유레카 같은 서비스 디스커버리 에이전트와 통합하는 것을 단순화, 서비스 소비자 호출에 대한 클라이언트 _부하 분산 기능_ 도 제공 👉 서비스 디스커버리 에이전트를 <u>일시적으로 가용하지 않을 때도 클라이언트가 서비스를 계속 호출 가능</u>

## 2.1.4 스프링 클라우드 API 게이트웨이

> 마이크로서비스 애플리케이션을 위한 **_서비스 라우팅 기능_** 제공

- 서비스 요청을 _프록싱_
- 대상 서비스가 호출되기 전에 마이크로서비스에 대한 모든 호출이 _현관_ 을 통과하도록 하는 서비스 게이트웨이
- 서비스 호출의 중앙 집중화 👉 보안 인가, 인증, 콘텐츠 필러팅, 라우팅 규칙 등 표준 서비스 정책 시행 가능

## 2.1.5 스프링 클라우드 스트림

> 경량 메시지 처리 기능을 마이크로서비스에 쉽게 통합하는 기술

- 애플리케이션에서 발생하는 비동기 이벤트를 사용하는 지능형 마이크로서비스 구축 가능
  - RabbitMQ, 카프카 같은 메시지 브로커와 마이크로서비스 빠르게 통합 가능

### 2.1.6 스프링 클라우드 슬루스

> 고유한 추척 식별자를 애플리케이션에서 사용되는 HTTP 호출 및 메시지 채널에 통합

- 상관관계ID, 트레이스ID 라고도 하는 추적 번호 사용시 애플리케이션 내 여러 서비스를 통과하는 트랜잭션 추적 가능
- 로깅 집계 기술 도구와 집킨 등과 같은 추적도구와 결합될 때 더욱 가치 있음
  - 일렉스틱 서치 : 검색 및 분석 엔진
  - 로그스태시 : 데이터를 소비한 후 "stash"로 전송하기 위해 변환하는 서버 사이드 데이터 프로세싱 파이프라인
  - 키바나 : 사용자가 전체 스택의 데이터를 질의하고 시각화 할 수 있는 클라이언트 UI </br>
    🗯 이 세 가지 오픈 소스 프로젝트를 합쳐 **_ELK_** 라고 부름

### 2.1.7 스프링 클라우드 시큐리티

> 서비스에 엑세스할 수 있는 사용자와 이 사용자가 서비스에서 수행할 수 있는 작업을 제어하는 인증 및 인가(권한 부여) 프레임워크

- 스프링 클라우드 시큐리티는 토큰을 기반으로 하여 서비스는 인증 시스템에서 발급된 토큰을 사용하여 서로 통신 가능
- HTTP 호출을 받는 각 서비스는 전달받은 토큰 확인해 사용자의 신원과 액세스 권한 검증
  - 스프링 클라우드 시큐리티 JWT(JSON Web Token) 지원
  - JWT는 OAuth2 토큰 생성 포맷을 표준화하고 생성된 토큰에 대한 서명을 정규화함
